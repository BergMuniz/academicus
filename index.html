<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academicus AI | NAP Unichristus</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; }
        
        /* Estilos da Pirâmide de Bloom */
        .bloom-step { transition: all 0.2s; cursor: pointer; border: 1px solid #e2e8f0; position: relative; }
        .bloom-step:hover { transform: scale(1.02); z-index: 10; }
        .bloom-step.active { border-color: #2563eb; background-color: #dbeafe; color: #1e40af; font-weight: 700; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
        
        /* Estilo dos Botões de Dificuldade */
        .diff-btn.active { border: 2px solid #2563eb; background-color: #eff6ff; color: #1e40af; }
        
        /* Estilo dos Modelos de Questão */
        .type-card.active { border-color: #2563eb; ring: 2px; ring-color: #2563eb; }

        /* Renderização Markdown */
        #ai-content h1 { font-size: 1.5rem; font-weight: 800; color: #1e40af; margin-bottom: 1rem; border-bottom: 2px solid #e2e8f0; padding-bottom: 0.5rem; }
        #ai-content p { margin-bottom: 1rem; line-height: 1.6; text-align: justify; }
        #ai-content strong { color: #0f172a; }
    </style>
</head>
<body class="bg-[#f8fafc] min-h-screen">

    <header class="bg-white border-b border-slate-200 px-6 py-3 flex items-center justify-between sticky top-0 z-50 shadow-sm">
        <div class="flex items-center gap-3">
            <div class="bg-blue-600 p-2 rounded-lg text-white shadow-lg"><i data-lucide="graduation-cap" class="w-6 h-6"></i></div>
            <div>
                <h1 class="text-xl font-extrabold text-slate-800 tracking-tighter leading-none">Academicus AI</h1>
                <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest mt-1">Inteligência Avaliativa para Ensino Superior</p>
            </div>
        </div>
        <div class="bg-blue-50 text-blue-700 px-4 py-2 rounded-full border border-blue-100 font-bold text-xs flex items-center gap-2">
            <i data-lucide="sparkles" class="w-3 h-3"></i> Powered by Gemini 3 Flash
        </div>
    </header>

    <main class="max-w-[1600px] mx-auto p-6 grid grid-cols-1 lg:grid-cols-12 gap-8">
        
        <aside class="lg:col-span-4 xl:col-span-3 space-y-6">
            
            <div class="bg-white rounded-3xl border border-slate-200 p-6 shadow-sm">
                <div class="flex gap-4 border-b border-slate-100 mb-6">
                    <button class="pb-3 border-b-2 border-blue-600 text-blue-600 font-bold text-xs flex items-center gap-2">
                        <i data-lucide="layout-template" class="w-4 h-4"></i> Design de Avaliação
                    </button>
                    <button class="pb-3 text-slate-400 font-bold text-xs flex items-center gap-2 hover:text-slate-600">
                        <i data-lucide="clipboard-check" class="w-4 h-4"></i> Auditoria Técnica
                    </button>
                </div>

                <h2 class="text-slate-800 font-bold mb-6 flex items-center gap-2 text-sm">
                    <i data-lucide="settings-2" class="text-blue-600 w-4 h-4"></i> Parâmetros da Questão
                </h2>

                <div class="space-y-4 mb-6">
                    <div>
                        <label class="block text-[11px] font-bold text-slate-500 mb-2 uppercase tracking-wide">Curso / Área de Conhecimento</label>
                        <input type="text" id="curso" class="w-full px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 text-sm outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-500/10 transition-all" placeholder="Ex: Medicina, Psicologia...">
                    </div>
                    <div>
                        <label class="block text-[11px] font-bold text-slate-500 mb-2 uppercase tracking-wide">Objeto de Conhecimento</label>
                        <textarea id="tema" rows="3" class="w-full px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 text-sm outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-500/10 transition-all" placeholder="Descreva o tema, competência ou habilidade..."></textarea>
                    </div>
                </div>

                <div class="mb-8">
                    <label class="block text-[11px] font-bold text-slate-500 mb-3 uppercase flex items-center gap-2">
                        <i data-lucide="bar-chart-3" class="w-3 h-3"></i> Nível de Dificuldade
                    </label>
                    <div class="grid grid-cols-3 gap-2">
                        <button onclick="setDiff('Fácil')" class="diff-btn py-3 rounded-xl border border-slate-200 text-[10px] font-bold text-slate-400 hover:bg-slate-50">Fácil</button>
                        <button onclick="setDiff('Médio')" class="diff-btn active py-3 rounded-xl border border-slate-200 text-[10px] font-bold text-slate-400 hover:bg-slate-50">Médio</button>
                        <button onclick="setDiff('Difícil')" class="diff-btn py-3 rounded-xl border border-slate-200 text-[10px] font-bold text-slate-400 hover:bg-slate-50">Difícil</button>
                    </div>
                </div>

                <div class="mb-8">
                    <div class="flex items-center justify-between mb-4">
                        <label class="text-[11px] font-bold text-slate-500 uppercase flex items-center gap-2">
                            <i data-lucide="brain" class="w-4 h-4 text-blue-600"></i> Taxonomia de Bloom
                        </label>
                        <span class="text-[9px] font-bold text-slate-400 uppercase tracking-tighter">Nível Cognitivo</span>
                    </div>
                    <div class="flex flex-col items-center gap-1">
                        <button onclick="setBloom('Criar')"   class="bloom-step active w-[50%] py-2 rounded-lg text-[10px]">Criar</button>
                        <button onclick="setBloom('Avaliar')"  class="bloom-step w-[60%] py-2 rounded-lg text-[10px]">Avaliar</button>
                        <button onclick="setBloom('Analisar')" class="bloom-step w-[70%] py-2 rounded-lg text-[10px]">Analisar</button>
                        <button onclick="setBloom('Aplicar')"  class="bloom-step w-[80%] py-2 rounded-lg text-[10px]">Aplicar</button>
                        <button onclick="setBloom('Entender')" class="bloom-step w-[90%] py-2 rounded-lg text-[10px]">Entender</button>
                        <button onclick="setBloom('Lembrar')"  class="bloom-step w-full py-2 rounded-lg text-[10px]">Lembrar</button>
                    </div>
                </div>

                <button onclick="gerarQuestao()" id="btnGerar" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-5 rounded-2xl shadow-xl shadow-blue-200 transition-all flex items-center justify-center gap-3 active:scale-95">
                    Gerar Questão <i data-lucide="zap" class="w-5 h-5"></i>
                </button>
            </div>
            
            <div class="space-y-3">
                <p class="text-[11px] font-bold text-slate-500 uppercase ml-2">Modelo da Questão</p>
                <div class="bg-white p-4 rounded-2xl border-2 border-blue-600 flex items-start gap-4 shadow-sm relative overflow-hidden">
                    <div class="bg-blue-50 p-2 rounded-lg text-blue-600"><i data-lucide="check-circle-2" class="w-5 h-5"></i></div>
                    <div>
                        <h4 class="text-xs font-bold text-slate-800">Resposta Única</h4>
                        <p class="text-[10px] text-slate-500 mt-1 leading-tight">Formato clássico com enunciado fechado e distratores plausíveis.</p>
                    </div>
                    <i data-lucide="check" class="absolute top-2 right-2 w-4 h-4 text-blue-600"></i>
                </div>
            </div>

        </aside>

        <section class="lg:col-span-8 xl:col-span-9">
            <div id="display-resultado" class="bg-white min-h-[850px] rounded-[2.5rem] border-2 border-dashed border-slate-200 flex flex-col items-center justify-center text-center p-12 transition-all">
                <div id="placeholder-content">
                    <div class="bg-slate-50 p-10 rounded-full mb-8 inline-block shadow-inner">
                        <i data-lucide="sparkles" class="w-16 h-16 text-slate-300"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-slate-400 uppercase tracking-tight">Aguardando Parâmetros</h3>
                    <p class="text-slate-400 max-w-sm mx-auto mt-4 text-sm font-medium leading-relaxed">
                        Preencha o curso e o tema à esquerda para que a inteligência artificial gere sua questão acadêmica baseada em evidências.
                    </p>
                </div>
                <div id="ai-content" class="hidden text-left w-full max-w-none"></div>
            </div>
        </section>

    </main>

    <script>
        // Inicializa Ícones
        lucide.createIcons();

        let selectedDiff = "Médio";
        let selectedBloom = "Criar";

        // Funções de Interface
        function setDiff(val) {
            document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            selectedDiff = val;
        }

        function setBloom(val) {
            document.querySelectorAll('.bloom-step').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            selectedBloom = val;
        }

        // Função de Comunicação com a IA (Vercel)
        async function gerarQuestao() {
            const curso = document.getElementById('curso').value;
            const tema = document.getElementById('tema').value;
            const btn = document.getElementById('btnGerar');
            const display = document.getElementById('display-resultado');
            const placeholder = document.getElementById('placeholder-content');
            const aiContent = document.getElementById('ai-content');

            if (!curso || !tema) return alert("Preencha o curso e o tema antes de gerar.");

            // Estado de Carregamento
            btn.disabled = true;
            btn.innerHTML = "Processando IA... <i data-lucide='loader-2' class='animate-spin w-5 h-5'></i>";
            lucide.createIcons();

            try {
                // Fetch para a API do Vercel
                const response = await fetch('/api/gemini', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        prompt: `Atue como um especialista em elaboração de questões do INEP. Gere uma questão de Resposta Única para o curso de ${curso} sobre o tema "${tema}". Dificuldade: ${selectedDiff}. Nível Cognitivo de Bloom: ${selectedBloom}. Inclua gabarito comentado e justificativa pedagógica.`
                    })
                });

                const data = await response.json();
                
                if(data.error) throw new Error(data.error);

                // Mostra o Resultado
                placeholder.classList.add('hidden');
                display.classList.remove('border-dashed', 'items-center', 'justify-center', 'text-center');
                display.classList.add('p-16', 'shadow-2xl');
                aiContent.innerHTML = marked.parse(data.text);
                aiContent.classList.remove('hidden');

            } catch (err) {
                alert("Erro ao conectar com a IA. Verifique se sua chave API está correta no Vercel.");
                console.error(err);
            } finally {
                btn.disabled = false;
                btn.innerHTML = "Gerar Questão <i data-lucide='zap' class='w-5 h-5'></i>";
                lucide.createIcons();
            }
        }
    </script>
</body>
</html>
